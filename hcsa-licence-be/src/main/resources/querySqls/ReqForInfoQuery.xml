<?xml version="1.0" encoding="UTF-8"?>
<sqls catalog="ReqForInfoQuery">

    <sql key = "applicationQuery" remarks = "Query Application Data by condition">
        <![CDATA[
            SELECT
                app.id,
                app.application_no,
                app.app_type,
                app.status,
                T3.HCI_CODE,
                T3.HCI_NAME,
                T3.BLK_NO, T3.FLOOR_NO, T3.UNIT_NO, T3.STREET_NAME, T3.BUILDING_NAME
            FROM APPLICATION AS app
             JOIN APP_PREMISES_CORRELATION T2 ON T2.APPLICATION_ID = app.ID
             JOIN APP_GRP_PREMISES T3 ON T3.ID = T2.APP_GRP_PREM_ID
            WHERE 1=1
            <#if id??> AND app.id = :id </#if>
            <#if appType??> AND app.app_type = :appType</#if>
            <#if appNo??> AND app.application_no = :appNo</#if>
            <#if appStatus??> AND app.status = :appStatus</#if>
            <#if sub_date??> AND T2.submit_dt => :sub_date</#if>
            <#if to_date??> AND T2.submit_dt =< :to_date</#if>
        ]]>
    </sql>


    <sql key = "licenceQuery" remarks = "Query Licence Data by condition">
        <![CDATA[
            SELECT
                lic.id as id,
                lic.licence_no as licence_no,
                lic.svc_name as svc_name,
                lic.STATUS as STATUS,
                lic.start_date as start_date,
                lic.expiry_date as expiry_date,
                licApp.APPLICATION_ID as APPLICATION_ID
            FROM LICENCE AS lic
            JOIN LIC_APP_CORRELATION licApp ON licApp.LICENCE_ID = lic.ID
            WHERE 1=1
            <#if licence_status??> AND lic.STATUS = :licence_status</#if>
            <#if sub_date??> AND lic.start_date => :sub_date</#if>
            <#if to_date??> AND lic.expiry_date =< :to_date</#if>
            <#if licence_no??> AND lic.licence_no = :licence_no</#if>
            <#if app_id??> AND licApp.APPLICATION_ID = :app_id</#if>
        ]]>
    </sql>

</sqls>