<?xml version="1.0" encoding="UTF-8"?>
<sqls catalog="ReqForInfoQuery">

    <sql key = "applicationQuery" remarks = "Query Application Data by condition">
        <![CDATA[
            SELECT
                app.id,app.application_no,app.app_type,app.status,
                T3.HCI_CODE,T3.HCI_NAME,
                T3.BLK_NO, T3.FLOOR_NO, T3.UNIT_NO, T3.STREET_NAME, T3.BUILDING_NAME,
                T4.LICENSEE_ID
            FROM APPLICATION AS app
             JOIN APP_PREMISES_CORRELATION T2 ON T2.APPLICATION_ID = app.ID
             JOIN APP_GRP_PREMISES T3 ON T3.ID = T2.APP_GRP_PREM_ID
             JOIN APPLICATION_GROUP T4 ON T4.ID = app.APP_GRP_ID

            WHERE 1=1
            <#if id??> AND app.id = :id </#if>
            <#if appType??> AND app.app_type = :appType</#if>
            <#if appNo??> AND app.application_no = :appNo</#if>
            <#if appStatus??> AND app.status = :appStatus</#if>
            <#if subDate??> AND T4.submit_dt >= convert(date,:subDate)</#if>
            <#if toDate??> AND T4.submit_dt <= convert(date,:toDate)</#if>
        ]]>
    </sql>


    <sql key = "licenceQuery" remarks = "Query Licence Data by condition">
        <![CDATA[
            SELECT
                lic.id as id,
                lic.licence_no as licence_no,
                lic.svc_name as svc_name,
                lic.STATUS as STATUS,
                lic.start_date as start_date,
                lic.expiry_date as expiry_date,
                lic.licensee_id,
                licApp.APPLICATION_ID as APPLICATION_ID,
                Prem.HCI_CODE,Prem.HCI_NAME,
                Prem.BLK_NO, Prem.FLOOR_NO, Prem.UNIT_NO, Prem.STREET_NAME, Prem.BUILDING_NAME,
                licPrem.ID as lic_prem_id
            FROM LICENCE AS lic
            JOIN LIC_PREMISES licPrem ON licPrem.LICENCE_ID = lic.ID
            JOIN PREMISES Prem ON Prem.ID = licPrem.PREMISES_ID
            JOIN LIC_APP_CORRELATION licApp ON licApp.LICENCE_ID = lic.ID
            WHERE 1=1
            <#if licence_status??> AND lic.STATUS = :licence_status</#if>
            <#if start_date??> AND lic.start_date >= :start_date</#if>
            <#if expiry_date??> AND lic.expiry_date <= :expiry_date</#if>
            <#if licence_no??> AND lic.licence_no = :licence_no</#if>
            <#if app_id??> AND licApp.APPLICATION_ID = :app_id</#if>
        ]]>
    </sql>
    <!--                LicPremisesAdhocChklItem.RISK_LEVEL-->

    <!--            JOIN lic_premises_adhoc_chkl_item LicPremisesAdhocChklItem ON licPrem.ID = LicPremisesAdhocChklItem.LIC_PREM_CORRE_ID-->

</sqls>