<?xml version="1.0" encoding="UTF-8"?>
<sqls catalog="hcsaconfig">
    <sql key = "queryHcsaService" remarks="query hcsa service parameter of checklist">
        <![CDATA[
            select stype.id as service_id, scategory.id as category_id, scategory.name as category_name, stype.name as service_name
            from iais.dbo.hcsa_service_type stype, iais.dbo.hcsa_service_category scategory where stype.category_id = scategory.id
        ]]>
    </sql>

    <sql key="listChklItem"  remarks="query chechlist items">
        <![CDATA[
                select item.id as ITEM_ID, regulation.CLAUSE_NO as CLAUSE_NO, regulation.clause as CLAUSE,
                item.question AS CHECKLISTITEM, item.answer_type as ANSWER_TYPE, item.risk_level as RISK_LEVEL,
                item.status as STATUS from chkl_config_hcsa_svc_item_pool item, chkl_config_hcsa_svc_regulation regulation where 1 = 1
                and item.regulation_id = regulation.id and item.status = 'CMSTAT001'
                <#if itemId??> and charindex(:itemId, item.id) >0</#if>
                <#if regulationClauseNo??> and charindex(:regulationClauseNo, regulation.clause_no) >0 </#if>
                <#if regulationClause??> and charindex(:regulationClause, regulation.clause) >0 </#if>
                <#if checklistItem??> and charindex(:checklistitem, item.question) >0</#if>
                <#if answerType??> and item.answer_type = :answerType</#if>
                <#if riskLevel??> and item.risk_level = :riskLevel</#if>
                <#if status??> and item.status = :status</#if>
        ]]>

    </sql>

    <sql key="listChecklistItemByItemId"  remarks="query chechlist items by item id">
        <![CDATA[
                select item.id as item_id, regulation.clause_no as clause_num, regulation.clause as clause,
                item.question as checklistitem, item.answer_type as answer_type, item.risk_level as risk_level,
                item.status as status from chkl_config_hcsa_svc_item_pool item, chkl_config_hcsa_svc_regulation regulation where 1 = 1
                and item.regulation_id = regulation.id and item.status = 'cmstat001'
                <#if itemid??> item.id in(:itemid)</#if>
        ]]>

    </sql>

    <sql key="listChecklistConfig" remarks="query results of checklist config">
        <![CDATA[
            select distinct svc.id as config_id,
            svc.module as module,
            svc.svc_subtype_name as subtype_name,
            svc.hci_code as hci_code,
            svc.[type] as type,
            svc.is_common as is_common,
            hcsa.svc_name as service,
            svc.EFFECTIVE_DATE as START_DATE,
            svc.end_date as END_DATE,
            svc.version as version
            from chkl_config_hcsa_service svc
            left join hcsa_service hcsa on svc.svc_code = hcsa.svc_code
            where (svc.is_common = 1 or svc.is_common = 0) and svc.status = 'CMSTAT001'
             <#if svcName??> and hcsa.svc_name = :svcName</#if>
             <#if common??> and svc.is_common = :common</#if>
             <#if module??> and svc.module = :module</#if>
             <#if type??> and svc.[type] = :type</#if>
             <#if svcSubType??> and hss.subtype_name = :svcSubType</#if>
        ]]>

    </sql>



    <sql key="listRegulationClauseNo"  remarks="query regulation no">
        <![CDATA[
                 select DISTINCT CLAUSE_NO as CLAUSE_NO from chkl_config_hcsa_svc_regulation
        ]]>

    </sql>


</sqls>

