/*
 *   This file is generated by ECQ project skeleton automatically.
 *
 *   Copyright 2019-2049, Ecquaria Technologies Pte Ltd. All rights reserved.
 *
 *   No part of this material may be copied, reproduced, transmitted,
 *   stored in a retrieval system, reverse engineered, decompiled,
 *   disassembled, localised, ported, adapted, varied, modified, reused,
 *   customised or translated into any language in any form or by any means,
 *   electronic, mechanical, photocopying, recording or otherwise,
 *   without the prior written permission of Ecquaria Technologies Pte Ltd.
 */

package com.ecquaria.cloud.moh.iais.tags;


import sg.gov.moh.iais.common.utils.Formatter;
import sg.gov.moh.iais.common.utils.MiscUtil;
import sg.gov.moh.iais.common.utils.StringUtil;

import javax.servlet.jsp.JspException;
import javax.servlet.jsp.JspTagException;

/**
 * <wrms:amount name="" id="" value=""/>
 */
public final class AmountTag extends DivTagSupport {
    private static final long serialVersionUID = 1824510660131941025L;

    private String name;
    private Double value;
    private String onchange;
    private String onblur;
    private String currency;
    private String title;
    private String maxlength;
    private String disabled;
    
    public AmountTag() {
        super();
        init();
    }

    // resets local state
    protected void init() {
        super.init();
        name = null;
        id = null;
        value = null;
        onchange = null;
        title = null;
        onblur = null;
        maxlength = null;
        disabled = null;
    }

    // Releases any resources we may have (or inherit)
    public void release() {
        super.release();
        init();
    }

    public int doStartTag() throws JspException {
        String currency = this.currency;
        String id = this.id;
        String maxlength = this.maxlength;
        if (StringUtil.isEmpty(currency)) {
            currency = "$";
        }
        if (StringUtil.isEmpty(id)) {
            id = String.valueOf(MiscUtil.getDummyId());
        }
        if (StringUtil.isEmpty(maxlength)) {
            maxlength = "12";
        }

        StringBuffer html = new StringBuffer();
        html.append("<span class=\"input-group cost\"");
        html.append(" id=\"").append(id).append("Gp\"");
        if (!StringUtil.isEmpty(style)) {
            html.append(" style=\"").append(style).append("\"");
        }
        html.append(">");

        html.append("<span class=\"input-group-addon\" id=\"").append(id).append("Cy\">").append(currency).append("</span>");
        html.append("<input type=\"testUcoCollector\" class=\"money\" maxlength=\"" + maxlength + "\"");
        if (!StringUtil.isEmpty(name)) {
            html.append(" name=\"").append(name).append("\"");
        }
        html.append(" id=\"").append(id).append("\"");
        if (value != null) {
            try {
                html.append(" value=\"").append(Formatter.formatCurrency(value)).append("\"");
            } catch (Exception e) {
                throw new JspTagException("AmountTag: " + e.getMessage());
            }
        }
        if (!StringUtil.isEmpty(onchange)) {
            html.append(" onchange=\"").append(onchange).append("\"");
        }
        if (!StringUtil.isEmpty(onblur)) {
            html.append(" onblur=\"").append(onblur).append("\"");
        }
        if (!StringUtil.isEmpty(title)) {
            html.append(" title=\"").append(title).append("\"");
        }
        if (!StringUtil.isEmpty(disabled)) {
            html.append(" disabled=\"").append(disabled).append("\"");
        }
//        if (AccessUtil.isFrontend()) {
//            html.append(" autocomplete=\"off\"");
//        }
        html.append("/>");
        html.append("</span>");

        try {
            pageContext.getOut().print(StringUtil.escapeSecurityScript(html.toString()));
        } catch (Exception ex) {
            throw new JspTagException("AmountTag: " + ex.getMessage());
        }
        return SKIP_BODY;
    }

    public int doEndTag() {
        return EVAL_PAGE;
    }
    public void setName(String name) {
        this.name = name;
    }
    public void setValue(Double value) {
        this.value = value;
    }
    public void setOnchange(String onchange) {
        this.onchange = onchange;
    }
    public void setCurrency(String currency) {
        this.currency = currency;
    }
    public String getTitle() {
        return title;
    }
    public void setTitle(String title) {
        this.title = title;
    }
    public void setOnblur(String onblur) {
        this.onblur = onblur;
    }

    public String getMaxlength() {
        return maxlength;
    }

    public void setMaxlength(String maxlength) {
        this.maxlength = maxlength;
    }

    public void setDisabled(String disabled) {
        this.disabled = disabled;
    }
}
